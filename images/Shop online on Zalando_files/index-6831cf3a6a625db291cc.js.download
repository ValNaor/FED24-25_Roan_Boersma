define(["classnames","react","rendering-engine-api","z-shop-event-bus"],(function(e,t,n,r){return(self.renderingEngineWebpackJsonp=self.renderingEngineWebpackJsonp||[]).push([[79989],{23838:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.def=void 0;var o=i(n(96708));t.def={queryId:o.id}},50831:function(e,t,n){"use strict";var r=n(85959);function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}t.A=function(e){var t=e.title,n=e.titleId,o=i(e,["title","titleId"]);return r.createElement("svg",a({viewBox:"0 0 24 24",width:"1em",height:"1em",fill:"currentColor","aria-labelledby":n},o),t?r.createElement("title",{id:n},t):null,r.createElement("path",{d:"M11.98 0c-6.628 0-12 5.373-12 12s5.372 12 12 12c6.627 0 12-5.373 12-12s-5.373-12-12-12M9.76 15.75a.75.75 0 1 1-1.5 0v-7.5a.75.75 0 0 1 1.5 0zm6 0a.75.75 0 1 1-1.5 0v-7.5a.75.75 0 0 1 1.5 0z"}))}},34062:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return q}});var r=n(85959),a=n(32740),i=n(28850),o=n(30812),l=n(21775),s=n.n(l),c=n(87548),d=n(3906),u=n(58777),f=n(41825),m=n(95141),v=n(31435),p=n(65476),h=n(58599),g=n(50831),y=n(79950);function S(){return S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},S.apply(this,arguments)}function b(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var E=function(e){var t=e.title,n=e.titleId,a=b(e,["title","titleId"]);return r.createElement("svg",S({viewBox:"0 0 24 24",width:"1em",height:"1em",fill:"currentColor","aria-labelledby":n},a),t?r.createElement("title",{id:n},t):null,r.createElement("path",{d:"m20.486 3.514-.01-.01a.75.75 0 1 0-1.052 1.07h.001c4.093 4.105 4.093 10.747 0 14.851a.75.75 0 1 0 1.06 1.06c4.678-4.69 4.678-12.28 0-16.97"}),r.createElement("path",{d:"m17.613 5.637-.01-.011a.75.75 0 0 0-1.052 1.07l.002.001.002.003a7.497 7.497 0 0 1-.002 10.603.75.75 0 0 0 1.06 1.06l.004-.003a8.997 8.997 0 0 0-.004-12.723M11.255 2.67c-.407 0-.806.11-1.155.32L1.84 7.946A2.25 2.25 0 0 0 .75 9.872v4.256c0 .79.414 1.52 1.09 1.926l8.26 4.956a2.245 2.245 0 0 0 3.4-1.925V4.915a2.245 2.245 0 0 0-2.245-2.245"}))},x=n(86610),w=n(36124),O=n(10170),k=n(32099),_=n(14936),I=n(47351),A=n(38856),N=n(5073),C=n(89862);const j=(e,t)=>e.map(((e,n)=>e||n<=t+1&&n>=t-1)),P=e=>{let{actionSuffix:t,contentId:n,enableStandaloneInShadow:r,enableStandaloneOnly:a,eventCategory:i,slideLabel:o,tracking:l}=e;l.track({name:C.wc,context:{customCategory:i,customActionSuffix:t,customLabel:o}},{enableStandaloneOnly:a});const s={name:"view_content",context:{content_id:n,legacy_event_name:C.wc,event_trigger_name:(t+"."+o).replace(/ /g,"_")}};l.trackStandalone(s,{enableStandaloneInShadow:r,enableStandaloneOnly:a})},T=e=>{let{actionSuffix:t,contentId:n,enableStandaloneInShadow:r,enableStandaloneOnly:a,eventCategory:i,slideLabel:o,tracking:l}=e;l.track({name:C.bD,context:{customCategory:i,customActionSuffix:t,customLabel:o}},{enableStandaloneOnly:a});const s={name:"select_content",context:{content_id:n,legacy_event_name:C.bD,event_trigger_name:(t+"."+o).replace(/ /g,"_")}};l.trackStandalone(s,{enableStandaloneInShadow:r,enableStandaloneOnly:a})};var D=n(23838);var L=e=>{let{isMobile:t,slideTiles:n,visitedSlides:a,currentSlideIndex:i,onNavigationHold:l,onNavigationLeftRelease:s,onNavigationRightRelease:d,short:u}=e;return r.createElement("div",{className:o(c.cky,_.Xv),style:{width:t?"100%":375,minHeight:t?"100%":666.6375}},n.length>0&&n.map(((e,t)=>a[t]?r.createElement("div",{key:"short-"+u.id+"-slide-"+t,className:o(k.Gm,_.Xv,{[N.lX]:t!==i})},e):null)),r.createElement("button",{className:o(_.Xv,c.DYq,c.l5b,c.d7k),style:{width:"50%",WebkitTapHighlightColor:"transparent"},onTouchStart:l,onMouseDown:l,onTouchEnd:s,onMouseUp:s}),r.createElement("button",{className:o(_.Xv,c.DYq,c.Er7,c.d7k),style:{width:"50%",WebkitTapHighlightColor:"transparent"},onTouchStart:l,onMouseDown:l,onTouchEnd:d,onMouseUp:d}))};var R=e=>{let{slideTiles:t,short:n,currentSlideIndex:a,progress:i}=e;return r.createElement("div",{className:o(k.Gm,N.OL,A.t4,c.d7k,c.DYq),style:{padding:"28px 24px 5px",zIndex:1001,filter:"drop-shadow(rgb(34, 34, 34) 0px 1px 8px)",transition:"opacity 400ms ease-in-out 0s",opacity:1,gap:4}},t.length>0&&t.map(((e,t)=>r.createElement("div",{key:"short-progress-"+n.id+"-slide-"+t,style:{flexGrow:1,height:2,background:"#ffffff4d",borderRadius:2}},r.createElement("div",{style:{background:"white",height:"100%",borderRadius:2,transform:t===a?"scaleX("+i/100+")":t<a?"scaleX(1)":"scaleX(0)",transformOrigin:"left center"}})))))};const X=function(e){var t;return void 0===e&&(e=""),document.getElementById("shorts-video-player-"+(null!=(t=e.split(":").pop())?t:""))},M=["story-cover-slide","entry-point-slide","media-slide","text-slide","talent-slide","product-slide","product-grid-slide","brand-bio-slide"];var q=(0,a.tile)().withQueries((e=>({data:{query:i,variables:{id:e.entity.id}}}))).withTracking((e=>({def:D.def,context:{id:e.entity.id}}))).withProcessDependencies((e=>{var t,n;const r=null==(t=e.data)?void 0:t.short;if(!r)return{action:"error",message:"Invalid short"};return{action:"render",data:{short:r},tiles:{slideTiles:((null==(n=r.slideEntities)?void 0:n.nodes)||[]).map((e=>{var t;const n=[];if("SteeringReason"===(null==(t=e.reason)?void 0:t.__typename)){var r;const t=null==(r=e.reason)?void 0:r.value;M.some((e=>t.startsWith(e)))?n.push(...e.reason.value.split(",")):n.push("media-slide")}return{id:e.id,hints:n}}))}}})).withRender((e=>{var t,n;const{slideTiles:i}=e.tiles,[l,S]=r.useState(!1),[b,C]=r.useState(0),[D,M]=r.useState(!1),[q,H]=r.useState(!1),[F,W]=r.useState(!1),[Y,z]=r.useState(!1),[G,B]=r.useState(true),U=r.useRef(),J=e.context.deviceInfo.isMobile,V=!0===e.ruleData.isFirstShort,Q=!0===e.ruleData.isLastShort,K=(null==(t=e.data.short.slideEntities)?void 0:t.nodes)||[];let Z=0;if(a.SessionStorage.exists()&&null!==a.SessionStorage.get("shorts")){const t=(a.SessionStorage.get("shorts")||{})[e.data.short.id];void 0!==t&&(Z=t)}const{url:{query:{slid:$}}}=e.context.navigation,ee=K.findIndex((e=>e.id===$));ee>-1&&(Z=ee);const[te,ne]=r.useState(Z),[re,ae]=r.useState(j(Array.from(Array(i.length)).map((()=>!1)),te)),ie=K[te],oe=r.useRef(),le=r.useRef();let se=b;const ce=t=>{null==le.current&&(le.current=t);const n=t-le.current;le.current=t,C((t=>(se=t+100*n/((e,t)=>{if(!e.duration)return 4e3;if(e.slideEntities&&e.slideEntities.nodes){const r=e.slideEntities.nodes[t];var n;if("Collection"===(null==r?void 0:r.__typename))return(null==(n=r.primaryVideo)?void 0:n.duration)||e.duration}return e.duration})(e.data.short,te),se))),se<100?oe.current=requestAnimationFrame(ce):(C(0),cancelAnimationFrame(oe.current||0),ve(!0))};r.useEffect((()=>{const e=!a.SessionStorage.exists()||null===a.SessionStorage.get("mute-shorts")||"true"===a.SessionStorage.get("mute-shorts");B(e);const t=()=>{S(!0),H(!0),M(!0)},n=()=>{C(0)},r=()=>{"visible"!==document.visibilityState?(S(!0),M(!0),H(l)):(S(q),M(q))};return window.addEventListener("visibilitychange",r),s().on("pauseSlide",t),s().on("reset-timer",n),()=>{s().off("pauseSlide",t),s().off("reset-timer",n),window.removeEventListener("visibilitychange",r)}}),[]),r.useEffect((()=>(l||(oe.current=requestAnimationFrame((e=>{le.current=e,ce(e)}))),window.dispatchEvent(new CustomEvent("playerIsPaused",{detail:l})),()=>{cancelAnimationFrame(oe.current||0)})),[te,l,q]);const de="SteeringReason"===(null==ie||null==(n=ie.reason)?void 0:n.__typename)&&ie.reason.value.includes("zoom-in"),ue="release slide.-."+("Collection"===(null==ie?void 0:ie.__typename)&&de?"motion":"Collection"===(null==ie?void 0:ie.__typename)&&ie.primaryVideo?"video":"static")+"."+((null==ie?void 0:ie.id)||"-"),fe={contentId:e.data.short.id,enableStandaloneInShadow:!!e.ruleData.enableStandaloneInShadowPrio2,enableStandaloneOnly:!!e.ruleData.enableStandaloneOnlyPrio2,eventCategory:"release short",slideLabel:ue,tracking:e.tools.tracking},me=()=>{T({actionSuffix:"backward",...fe}),W(!1),te>0?ne(te-1):s().trigger("previous-short")},ve=e=>{W(!1),C(0),e?P({actionSuffix:"slide end",...fe}):T({actionSuffix:"forward",...fe}),te<i.length-1?ne(te+1):s().trigger("next-short")},pe={"--color-background-default":"transparent"};r.useEffect((()=>{let e;return F?e=setTimeout((()=>{z(!0),P({actionSuffix:"video buffering",...fe})}),1e3):z(!1),()=>{clearTimeout(e)}}),[F]),r.useEffect((()=>{var t,n;null==(n=e.data.short.slideEntities)||null==(t=n.nodes)||t.forEach(((e,t)=>{const n=X(e.id);n&&(t===te?(n.play().catch((()=>{n.muted=!0,B(!0),a.SessionStorage.exists()&&a.SessionStorage.remove("mute-shorts"),n.play().catch((()=>{}))})),n.muted=G):(n.pause(),n.currentTime=0))}))}),[te,re]),r.useEffect((()=>{var t;C(0),S(!1),ae(j(re,te));const n=null==(t=e.entity)?void 0:t.fragmentsData,r="object"==typeof n&&null!==n,i=e.data.short,o=r?((e,t,n)=>{if("collection"in e&&"object"==typeof e.collection&&null!==e.collection&&"id"in e.collection){var r,a;const o=null==e||null==(r=e.collection)?void 0:r.id;if(t&&(null==(a=t.slideEntities)?void 0:a.nodes)){var i;const e=null==(i=t.slideEntities)?void 0:i.nodes[n];return{cid:o,sid:t.id,slid:e.id,query:"cid="+o+"&sid="+t.id+"&slid="+e.id}}}return null})(n,i,te):null,l=new URL(window.location.href);if(l.searchParams.delete("cid"),l.searchParams.delete("sid"),l.searchParams.delete("slid"),o){window.history.replaceState({cid:o.cid,sid:o.sid,slid:o.slid},"",l.href.includes("?")?l.href+"&"+(null==o?void 0:o.query):l.href+"?"+(null==o?void 0:o.query));((e,t)=>{if(a.SessionStorage.exists()){let n=a.SessionStorage.get("shorts")||{};n={...n,[e]:t},a.SessionStorage.set("shorts",n)}})(o.sid,te)}window.dispatchEvent(new CustomEvent("playerIsOpen",{detail:!0}))}),[te]);const he=e=>{T({actionSuffix:l?"video play":"video pause",...fe});const t=X(null==ie?void 0:ie.id);t&&(l?t.play().catch((()=>{})):t.pause()),H(!l),S(!l),M(!D),e.stopPropagation()},ge=(e,t)=>{e.preventDefault(),U.current&&clearTimeout(U.current),l?he(e):t()};return r.createElement(r.Fragment,null,r.createElement("div",{className:o(A.Fn,N.lX,N.lw)},r.createElement(d.A,{className:o(f.YW,{[I.lW]:!(te>0||!V)}),style:pe,preset:u.lH.primary,onClick:me},r.createElement(w.A,{src:v.A}))),r.createElement("div",{className:o(k.Gm,O.b7H,O.Y3k,O._tN,O.Hp6,c.cky,_.Xv,N.OL,A.Fn)},r.createElement("div",{className:o(c.cky,_.Xv,k.Gm,A.t4,N.OL,A.vF),onPlay:()=>{W(!1)},onWaiting:()=>{S(!0),W(!0)},onPlaying:()=>{S(!1),W(!1)}},r.createElement("div",{className:o(c.cky,{[_.Xv]:J},O.cUX)},r.createElement(R,{currentSlideIndex:te,progress:b,short:e.data.short,slideTiles:i}),r.createElement("div",{className:c.DYq,style:{top:"40px",right:J?"60px":"20px",zIndex:9999}},Y?r.createElement(d.A,{style:{...pe,backgroundColor:"transparent",color:"lightgray"},preset:u.lH.transparent},r.createElement(w.A,{src:p.A,className:o(m.m)})):r.createElement(d.A,{style:{...pe,backgroundColor:"transparent",color:"lightgray"},onClick:he,preset:u.lH.transparent},r.createElement(w.A,{src:l?h.A:g.A})),r.createElement(d.A,{preset:u.lH.transparent,style:{...pe,backgroundColor:"transparent",color:"lightgray"},onClick:()=>{a.SessionStorage.exists()&&(G?a.SessionStorage.set("mute-shorts","false"):a.SessionStorage.remove("mute-shorts"));const e=X(null==ie?void 0:ie.id);e&&(e.muted=!G),T({actionSuffix:G?"unmute":"mute",...fe}),B(!G)}},r.createElement(w.A,{src:G?y.A:E}))),r.createElement(L,{short:e.data.short,isMobile:J,slideTiles:i,visitedSlides:re,currentSlideIndex:te,onNavigationHold:e=>{U.current=setTimeout((()=>{he(e)}),200)},onNavigationLeftRelease:e=>ge(e,me),onNavigationRightRelease:e=>ge(e,(()=>ve(!1)))})))),r.createElement("div",{className:o(A.Fn,N.lX,N.lw)},r.createElement(d.A,{style:pe,onClick:()=>ve(!1),className:o(f.YW,{[I.lW]:!(()=>{var t;const n=e.data.short;return(null==(t=n.slideEntities)?void 0:t.nodes)&&!(Q&&te>=n.slideEntities.nodes.length-1)})()}),preset:u.lH.primary},r.createElement(w.A,{src:x.A}))))}))},28850:function(e){e.exports={id:"3bc7ad3b15ddac5d119fc98499c7333a85cdc61f5940a39a21bfc29638257699"}},30812:function(t){"use strict";t.exports=e},85959:function(e){"use strict";e.exports=t},32740:function(e){"use strict";e.exports=n},21775:function(e){"use strict";e.exports=r},96708:function(e){"use strict";e.exports=JSON.parse('{"id":"fb768e9fdf03fc8bf592fc24519b22ed21cb966090ce50df7f2c93f683ad1e91"}')}},function(e){return e.O(0,[29674],(function(){return t=34062,e(e.s=t);var t})),e.O()}])}));
//# sourceMappingURL=https://zalando.de/dev/source-maps/short_player/index-a6531eaebd368a320cfc.map